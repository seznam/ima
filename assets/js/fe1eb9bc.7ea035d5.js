"use strict";(self.webpackChunk_ima_docs=self.webpackChunk_ima_docs||[]).push([[1820],{8880:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>a,contentTitle:()=>c,default:()=>p,frontMatter:()=>s,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"introduction/configuration","title":"Configuration options","description":"Introduction > IMA.js application configuration options","source":"@site/../docs/introduction/configuration.md","sourceDirName":"introduction","slug":"/introduction/configuration","permalink":"/introduction/configuration","draft":false,"unlisted":false,"editUrl":"https://github.com/seznam/ima/tree/master/docs/../docs/introduction/configuration.md","tags":[],"version":"current","lastUpdatedBy":"Jan \u0160ime\u010dek","lastUpdatedAt":1761308686000,"frontMatter":{"title":"Configuration options","description":"Introduction > IMA.js application configuration options"},"sidebar":"docs","previous":{"title":"Getting Started with IMA.js","permalink":"/introduction/getting-started"},"next":{"title":"Controller lifecycle","permalink":"/basic-features/controller-lifecycle"}}');var o=i(2540),r=i(3023);const s={title:"Configuration options",description:"Introduction > IMA.js application configuration options"},c=void 0,a={},d=[{value:"Build and environment configuration",id:"build-and-environment-configuration",level:2},{value:"Application configuration",id:"application-configuration",level:2},{value:"Environments",id:"environments",level:2},{value:"TypeScript support",id:"typescript-support",level:3}];function l(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.p,{children:"IMA.js offers many ways to configure and customize your application to your needs."}),"\n",(0,o.jsxs)(n.p,{children:["Make sure this file is included in your ",(0,o.jsx)(n.code,{children:"tsconfig.json"}),". This will provide proper type-checking and autocomplete for your custom environments within the IMA.js application."]}),"\n",(0,o.jsx)(n.p,{children:"Here's a list describing all possible configuration files and what they do."}),"\n",(0,o.jsx)(n.h2,{id:"build-and-environment-configuration",children:"Build and environment configuration"}),"\n",(0,o.jsx)(n.admonition,{type:"info",children:(0,o.jsxs)(n.p,{children:["Environment configuration is resolved on server and passed to the client settings under ",(0,o.jsx)(n.code,{children:"config"})," param."]})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.code,{children:"app/main.js"})," is the bootstrap of your application, initializing your application. You don't need to concern yourself with this file usually."]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.code,{children:"server/config/environment.js"})," configures the server-side environment. Note that the\n",(0,o.jsx)(n.code,{children:"dev"})," and ",(0,o.jsx)(n.code,{children:"test"})," environment configuration automatically inherits values from\nthe ",(0,o.jsx)(n.code,{children:"prod"})," environment. This configuration is well-described in the comments, so see\n",(0,o.jsx)(n.a,{href:"https://github.com/seznam/ima/blob/master/packages/create-ima-app/template/common/server/config/environment.js",children:"the file"}),"\nfor a full reference."]}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"application-configuration",children:"Application configuration"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.code,{children:"app/config/services.js"})," by default this file specifies how the fatal\napplication errors should be handled at the client side. It also provides a way\nto configure other application-wide settings or 3rd party libraries\n(analytics, etc.)."]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.code,{children:"app/config/routes.js"})," configures your router, mapping routes to the\ncontrollers and views in your application. For more information, see the\n",(0,o.jsx)(n.a,{href:"/basic-features/routing/introduction",children:"Routing"})," page."]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.code,{children:"app/config/settings.js"})," configures your application and IMA.js services. You\ncan freely extend the configuration as you like except for the properties\nprefixed by a dollar sign ",(0,o.jsx)(n.code,{children:"$"}),".\nNote that, again, the ",(0,o.jsx)(n.code,{children:"dev"})," and ",(0,o.jsx)(n.code,{children:"test"})," environment configuration\nautomatically inherits values from the ",(0,o.jsx)(n.code,{children:"prod"})," environment."]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.code,{children:"app/config/bind.js"})," configures the\n",(0,o.jsx)(n.a,{href:"/basic-features/object-container",children:"Object container"}),"."]}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"All of these files are necessary and must remain in their locations."}),"\n",(0,o.jsx)(n.h2,{id:"environments",children:"Environments"}),"\n",(0,o.jsxs)(n.p,{children:["By default, IMA.js comes with three predefined environments: ",(0,o.jsx)(n.code,{children:"prod"}),", ",(0,o.jsx)(n.code,{children:"dev"}),", and ",(0,o.jsx)(n.code,{children:"test"}),". The application automatically selects one based on the ",(0,o.jsx)(n.code,{children:"NODE_ENV"})," environment variable. The ",(0,o.jsx)(n.code,{children:"dev"})," and ",(0,o.jsx)(n.code,{children:"test"})," environments inherit settings from the ",(0,o.jsx)(n.code,{children:"prod"})," environment, allowing you to only specify the differences."]}),"\n",(0,o.jsxs)(n.p,{children:["For more complex use cases, for example, if you need ",(0,o.jsx)(n.code,{children:"beta"})," or ",(0,o.jsx)(n.code,{children:"stage"})," environments that are built with ",(0,o.jsx)(n.code,{children:"NODE_ENV=production"})," but use a different set of configurations, you can use the ",(0,o.jsx)(n.code,{children:"IMA_ENV"})," environment variable."]}),"\n",(0,o.jsxs)(n.p,{children:["The ",(0,o.jsx)(n.code,{children:"IMA_ENV"})," variable has precedence over ",(0,o.jsx)(n.code,{children:"NODE_ENV"})," when determining which configuration to load from your ",(0,o.jsx)(n.code,{children:"environment.js"})," and ",(0,o.jsx)(n.code,{children:"config/settings.js"})," files."]}),"\n",(0,o.jsxs)(n.p,{children:["For example, to run your application using a ",(0,o.jsx)(n.code,{children:"beta"})," environment configuration, you would define it in ",(0,o.jsx)(n.code,{children:"environment.js"})," and ",(0,o.jsx)(n.code,{children:"config/settings.js"}),", and then run your application like this:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-sh",children:"ima build && IMA_ENV=beta NODE_ENV=production ima start\n"})}),"\n",(0,o.jsx)(n.h3,{id:"typescript-support",children:"TypeScript support"}),"\n",(0,o.jsx)(n.p,{children:"When using TypeScript and defining custom environments, you'll need to update IMA.js's type definitions to include your new environments. This can be achieved using module augmentation."}),"\n",(0,o.jsxs)(n.p,{children:["First, create a new type definition file, for example ",(0,o.jsx)(n.code,{children:"types/ima-environment.d.ts"}),", and add the following content, replacing ",(0,o.jsx)(n.code,{children:"beta"})," and ",(0,o.jsx)(n.code,{children:"stage"})," with your custom environment names:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-typescript",children:"// types/ima-environment.d.ts\nimport {\n  Environment,\n  Settings,\n} from '@ima/core';\nimport type { PartialDeep } from 'type-fest';\n\ndeclare module '@ima/core' {\n  interface AppEnvironment\xa0{\n    beta?: PartialDeep<Environment>;\n    stage?: PartialDeep<Environment>;\n  }\n\n  interface AppSettings\xa0{\n    beta?: PartialDeep<Settings>;\n    stage?: PartialDeep<Settings>;\n  }\n}\n\n// This is needed to not completely override the core types\nexport {};\n"})})]})}function p(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(l,{...e})}):l(e)}},3023:(e,n,i)=>{i.d(n,{R:()=>s,x:()=>c});var t=i(3696);const o={},r=t.createContext(o);function s(e){const n=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:s(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);
"use strict";(self.webpackChunk_ima_docs=self.webpackChunk_ima_docs||[]).push([[1778],{2734:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>c,contentTitle:()=>i,default:()=>h,frontMatter:()=>o,metadata:()=>n,toc:()=>d});const n=JSON.parse('{"id":"basic-features/routing/dynamic-routes","title":"Dynamic Routes","description":"Basic features > Routing > Dynamic Routes","source":"@site/../docs/basic-features/routing/dynamic-routes.md","sourceDirName":"basic-features/routing","slug":"/basic-features/routing/dynamic-routes","permalink":"/basic-features/routing/dynamic-routes","draft":false,"unlisted":false,"editUrl":"https://github.com/seznam/ima/tree/master/docs/../docs/basic-features/routing/dynamic-routes.md","tags":[],"version":"current","lastUpdatedBy":"Jan \u0160ime\u010dek","lastUpdatedAt":1761308686000,"frontMatter":{"title":"Dynamic Routes","description":"Basic features > Routing > Dynamic Routes"},"sidebar":"docs","previous":{"title":"Introduction","permalink":"/basic-features/routing/introduction"},"next":{"title":"Middlewares","permalink":"/basic-features/routing/middlewares"}}');var s=r(2540),a=r(3023);const o={title:"Dynamic Routes",description:"Basic features > Routing > Dynamic Routes"},i=void 0,c={},d=[{value:"Creating Dynamic Routes",id:"creating-dynamic-routes",level:2},{value:"matcher",id:"matcher",level:3},{value:"extractParameters",id:"extractparameters",level:3},{value:"toPath",id:"topath",level:3}];function u(e){const t={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",p:"p",pre:"pre",strong:"strong",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(t.p,{children:["Dynamic routes allows you to take control of ",(0,s.jsx)(t.strong,{children:"route matching"}),", ",(0,s.jsx)(t.strong,{children:"route parameters parsing"})," and ",(0,s.jsx)(t.strong,{children:"generation of router links"}),"."]}),"\n",(0,s.jsxs)(t.p,{children:["They are really powerful and can help you cover those edge cases that cannot be done using ",(0,s.jsx)(t.a,{href:"/basic-features/routing/introduction#setting-up-router",children:"basic string route expressions"}),"."]}),"\n",(0,s.jsxs)(t.p,{children:["This can be achieved by defining ",(0,s.jsx)(t.strong,{children:"custom route matcher"})," in form of a ",(0,s.jsx)(t.strong,{children:"regular expression"})," and custom functions to parse router params from path and, the other way, from route params to path."]}),"\n",(0,s.jsx)(t.admonition,{type:"note",children:(0,s.jsx)(t.p,{children:"The power of dynamic routes comes at a cost. You have to be really sure to define your matchers and function overrides correctly, so you don't end up with false positive route matches. We advise to cover these matchers heavily with tests in order to prevent potential failures."})}),"\n",(0,s.jsx)(t.h2,{id:"creating-dynamic-routes",children:"Creating Dynamic Routes"}),"\n",(0,s.jsxs)(t.p,{children:["Dynamic routes can be created just like the regular (static routes). The only thing that's different is the ",(0,s.jsx)(t.a,{href:"/basic-features/routing/introduction#pathexpression",children:(0,s.jsx)(t.code,{children:"pathExpression"})})," positional argument, which is now object with three properties: ",(0,s.jsx)(t.code,{children:"matcher"}),", ",(0,s.jsx)(t.code,{children:"toPath"})," and ",(0,s.jsx)(t.code,{children:"extractParameters"}),"."]}),"\n",(0,s.jsxs)(t.p,{children:["The following example parses ",(0,s.jsx)(t.code,{children:"/category/subcategory/post/124"})," url formats with optional categories, and extract them along with the post ",(0,s.jsx)(t.code,{children:"itemId"}),":"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-js",metastring:"title=./app/config/routes.js",children:"import { AbstractRoute } from '@ima/core';\n\nimport PostController from 'app/page/post/PostController';\nimport PostView from 'app/page/post/PostView';\n\nconst POST_MATCHER = /([\\w-]+)?\\/?([\\w-]+)?\\/post\\/(\\d+)/i;\n\nexport let init = (ns, oc, config) => {\n  const router = oc.get('$Router');\n\n  router.add(\n    'post',\n    {\n      matcher: POST_MATCHER,\n      extractParameters: (trimmedPath, ({ query, path })) => {\n        const [match, category, subcategory, itemId] =\n          POST_MATCHER.exec((trimmedPath)));\n\n        return {\n          category,\n          subcategory,\n          itemId,\n        };\n      },\n      toPath: params => {\n        const { category, subcategory, itemId, ...restParams } = params;\n        const query = new URLSearchParams(restParams).toString();\n\n        return [category, subcategory, itemId].filter(i => !!i).join('/') +\n          (query ? `?${query}` : '');\n      }\n    },\n    PostController,\n    PostView\n  );\n}\n"})}),"\n",(0,s.jsxs)(t.admonition,{type:"info",children:[(0,s.jsxs)(t.p,{children:["Notice that in the ",(0,s.jsx)(t.code,{children:"toPath"})," function, we're appending other unused params to the final path as query params. This is to mimic the same functionality as the ",(0,s.jsx)(t.a,{href:"../../api/classes/ima_core.StaticRoute.md",children:(0,s.jsx)(t.code,{children:"StaticRoutes"})})," provide by default."]}),(0,s.jsxs)(t.p,{children:["To make this process easier you can use the ",(0,s.jsx)(t.code,{children:"AbstractRoute.paramsToQuery()"})," helper method, which filters and transforms object key-value pairs to query params string."]})]}),"\n",(0,s.jsx)(t.h3,{id:"matcher",children:"matcher"}),"\n",(0,s.jsxs)(t.blockquote,{children:["\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.code,{children:"RegExp"})}),"\n"]}),"\n",(0,s.jsxs)(t.p,{children:["Regular expression used in route matching. The router tries to match ",(0,s.jsx)(t.strong,{children:"path"}),", ",(0,s.jsx)(t.strong,{children:"stripped from trailing slashes"}),", against this regular expression."]}),"\n",(0,s.jsx)(t.h3,{id:"extractparameters",children:"extractParameters"}),"\n",(0,s.jsxs)(t.blockquote,{children:["\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.code,{children:"(trimmedPath: string, { query: RouteParams; path: string }) => RouteParams"})}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"Function used to extract route params from given path. It receives path trimmed from trailing slashes and query params as first argument."}),"\n",(0,s.jsxs)(t.p,{children:["For more control, you can use additional data in form of ",(0,s.jsx)(t.code,{children:"query"})," and ",(0,s.jsx)(t.code,{children:"path"})," which contain query params extracted from trimmed path and full path without any modifications."]}),"\n",(0,s.jsx)(t.admonition,{type:"note",children:(0,s.jsxs)(t.p,{children:["When using ",(0,s.jsx)(t.a,{href:"../../api/classes/ima_core.StaticRoute.md",children:(0,s.jsx)(t.code,{children:"StaticRoutes"})}),", query parameters are automatically merged with extracted route params. If you want to mimic this behavior, don't forget to merge ",(0,s.jsx)(t.code,{children:"query"})," params into your final route params object."]})}),"\n",(0,s.jsx)(t.h3,{id:"topath",children:"toPath"}),"\n",(0,s.jsxs)(t.blockquote,{children:["\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.code,{children:"(params: RouteParams) => string"})}),"\n"]}),"\n",(0,s.jsxs)(t.p,{children:["Function used to create path from given params (including query params). It is used mainly in the ",(0,s.jsx)(t.a,{href:"/basic-features/routing/introduction#linking-between-routes",children:"router link creation"}),"."]}),"\n",(0,s.jsx)(t.admonition,{type:"note",children:(0,s.jsxs)(t.p,{children:["It is a good practice to ",(0,s.jsx)(t.strong,{children:"append any unused params as query params"})," to the path (you can use the static ",(0,s.jsx)(t.code,{children:"AbstractRoute.paramsToQuery()"})," static helper to do that)."]})})]})}function h(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(u,{...e})}):u(e)}},3023:(e,t,r)=>{r.d(t,{R:()=>o,x:()=>i});var n=r(3696);const s={},a=n.createContext(s);function o(e){const t=n.useContext(a);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function i(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),n.createElement(a.Provider,{value:t},e.children)}}}]);